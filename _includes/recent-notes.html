{% comment %}
USAGE EXAMPLES:
{% include notes-list.html type="journal" %}
{% include notes-list.html type="journal" show_dates=false %}
{% include notes-list.html type="journal" group_by_year=true show_dates=true %}
{% include notes-list.html type="journal" limit="20" group_by_year=true %}
{% endcomment %}

{% assign raw_types = include.type | split: ',' %}
{% assign types = "" | split: "" %}

{% for t in raw_types %}
  {% assign trimmed = t | strip %}
  {% assign types = types | push: trimmed %}
{% endfor %}

{% assign notes_all = site.notes | where_exp: "note", "types contains note.type" | sort: "date" | reverse %}

{% if include.limit %}
  {% assign notes = notes_all | slice: 0, include.limit %}
{% else %}
  {% assign notes = notes_all %}
{% endif %}

{% assign show_dates_raw = include.show_dates | default: true %}
{% assign show_dates_str = show_dates_raw | downcase %}
{% assign show_dates = show_dates_str != "false" and show_dates_str != "0" %}

{% assign group = include.group_by_year | default: false %}

<ul class="no-bullets">

{% if group %}
  {% assign current_year = "" %}
  {% for note in notes %}
    {% assign note_year = note.date | date: "%Y" %}

    {% if note_year != current_year %}
      {% unless forloop.first %}</ul>{% endunless %}
      <h3 class="year-heading">{{ note_year }}</h3>
      <ul class="no-bullets">
      {% assign current_year = note_year %}
    {% endif %}

  <li class="note-row">
    {% if show_dates %}
    <span class="note-date-prefix">
      {% if group %}
        {{ note.date | date: "%B %d" }}
      {% else %}
        {{ note.date | date: "%Y · %m" }}
      {% endif %}
    </span>
    {% endif %}
    <span class="note-title-wrap">
      <a class="internal-link note-title" href="{{ site.baseurl }}{{ note.url }}">
        {{ note.title }}
      </a>
    </span>
  </li>
  {% endfor %}

{% else %}
  {% for note in notes %}
  <li class="note-row">
    {% if show_dates %}
      <span class="note-date-prefix">
        {{ note.date | date: "%Y · %m" }}
      </span>
    {% endif %}
    <span class="note-title-wrap">
      <a class="internal-link note-title" href="{{ site.baseurl }}{{ note.url }}">
        {{ note.title }}
      </a>
    </span>
  </li>

  {% endfor %}
{% endif %}

</ul>
